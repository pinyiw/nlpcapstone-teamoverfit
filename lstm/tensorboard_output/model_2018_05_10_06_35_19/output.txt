X: (269, 3, 6001)
y: (269, 1)
Default configuration: {'num_steps': 5, 'num_features': 5001, 'num_classes': 1, 'stay_percent': 0.005, 'include_stopwords': False, 'num_hidden': 1000, 'num_layers': 5, 'dropout': 0.5, 'batch_size': 16, 'num_epoch': 200, 'company': 'apple'}
X: (267, 5, 5001)
y: (267, 1)
train data shape: (213, 5, 5001)
train target shape: (213, 1)
/home/sdw/miniconda3/envs/nlp-capstone/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py:100: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
2018-05-10 06:35:26.570390: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
Epoch  1 cost:  4.959 train error: 63.38% test error: 62.96%
Epoch  2 cost:  4.640 train error: 63.38% test error: 62.96%
Epoch  3 cost:  4.236 train error: 62.44% test error: 59.26%
Epoch  4 cost:  4.023 train error: 62.91% test error: 61.11%
Epoch  5 cost:  3.983 train error: 70.42% test error: 72.22%
Epoch  6 cost:  3.960 train error: 71.83% test error: 81.48%
Epoch  7 cost:  3.918 train error: 64.79% test error: 72.22%
Epoch  8 cost:  3.837 train error: 66.20% test error: 70.37%
Epoch  9 cost:  3.722 train error: 68.54% test error: 74.07%
Epoch 10 cost:  3.595 train error: 70.42% test error: 83.33%
Epoch 11 cost:  3.322 train error: 64.79% test error: 61.11%
Epoch 12 cost:  3.031 train error: 65.26% test error: 66.67%
Epoch 13 cost:  2.766 train error: 66.20% test error: 68.52%
Epoch 14 cost:  2.549 train error: 62.44% test error: 64.81%
Epoch 15 cost:  2.402 train error: 73.24% test error: 83.33%
Epoch 16 cost:  2.232 train error: 70.89% test error: 87.04%
Epoch 17 cost:  1.986 train error: 63.85% test error: 64.81%
Epoch 18 cost:  1.855 train error: 69.95% test error: 81.48%
Epoch 19 cost:  1.641 train error: 69.95% test error: 68.52%
Epoch 20 cost:  1.509 train error: 63.85% test error: 62.96%
Epoch 21 cost:  1.424 train error: 63.38% test error: 62.96%
Epoch 22 cost:  1.220 train error: 63.38% test error: 57.41%
Epoch 23 cost:  1.103 train error: 66.20% test error: 64.81%
Epoch 24 cost:  1.003 train error: 72.30% test error: 85.19%
Epoch 25 cost:  0.887 train error: 61.03% test error: 53.70%
Epoch 26 cost:  0.796 train error: 66.20% test error: 57.41%
Epoch 27 cost:  0.713 train error: 66.20% test error: 55.56%
Epoch 28 cost:  0.637 train error: 63.38% test error: 66.67%
Epoch 29 cost:  0.563 train error: 65.26% test error: 48.15%
Epoch 30 cost:  0.506 train error: 66.67% test error: 50.00%
Epoch 31 cost:  0.447 train error: 66.67% test error: 68.52%
Epoch 32 cost:  0.390 train error: 68.08% test error: 62.96%
Epoch 33 cost:  0.340 train error: 66.67% test error: 62.96%
Epoch 34 cost:  0.299 train error: 69.01% test error: 68.52%
Epoch 35 cost:  0.265 train error: 63.38% test error: 51.85%
Epoch 36 cost:  0.232 train error: 69.01% test error: 68.52%
Epoch 37 cost:  0.202 train error: 66.67% test error: 59.26%
Epoch 38 cost:  0.179 train error: 64.32% test error: 59.26%
Epoch 39 cost:  0.156 train error: 68.54% test error: 66.67%
Epoch 40 cost:  0.136 train error: 60.09% test error: 55.56%
Epoch 41 cost:  0.116 train error: 67.61% test error: 46.30%
Epoch 42 cost:  0.107 train error: 65.26% test error: 72.22%
Epoch 43 cost:  0.090 train error: 64.32% test error: 61.11%
Epoch 44 cost:  0.081 train error: 66.20% test error: 75.93%
Epoch 45 cost:  0.075 train error: 66.20% test error: 61.11%
Epoch 46 cost:  0.064 train error: 71.83% test error: 57.41%
Epoch 47 cost:  0.066 train error: 64.79% test error: 75.93%
Epoch 48 cost:  0.057 train error: 64.79% test error: 53.70%
Epoch 49 cost:  0.062 train error: 70.89% test error: 75.93%
Epoch 50 cost:  0.047 train error: 64.32% test error: 57.41%
Epoch 51 cost:  0.044 train error: 62.91% test error: 62.96%
Epoch 52 cost:  0.040 train error: 61.03% test error: 61.11%
Epoch 53 cost:  0.040 train error: 64.32% test error: 68.52%
Epoch 54 cost:  0.037 train error: 69.01% test error: 61.11%
Epoch 55 cost:  0.035 train error: 64.32% test error: 57.41%
Epoch 56 cost:  0.037 train error: 65.26% test error: 50.00%
Epoch 57 cost:  0.035 train error: 63.38% test error: 50.00%
Epoch 58 cost:  0.031 train error: 64.32% test error: 61.11%
Epoch 59 cost:  0.031 train error: 64.79% test error: 55.56%
Epoch 60 cost:  0.031 train error: 65.26% test error: 55.56%
Epoch 61 cost:  0.032 train error: 64.79% test error: 53.70%
Epoch 62 cost:  0.036 train error: 69.48% test error: 77.78%
Epoch 63 cost:  0.032 train error: 67.14% test error: 57.41%
Epoch 64 cost:  0.031 train error: 61.97% test error: 50.00%
Epoch 65 cost:  0.030 train error: 64.79% test error: 51.85%
Epoch 66 cost:  0.029 train error: 64.79% test error: 61.11%
Epoch 67 cost:  0.030 train error: 62.44% test error: 50.00%
Epoch 68 cost:  0.032 train error: 72.30% test error: 70.37%
Epoch 69 cost:  0.028 train error: 65.73% test error: 55.56%
Epoch 70 cost:  0.029 train error: 66.67% test error: 57.41%
Epoch 71 cost:  0.031 train error: 64.79% test error: 57.41%
Epoch 72 cost:  0.027 train error: 66.67% test error: 53.70%
Epoch 73 cost:  0.038 train error: 69.01% test error: 77.78%
Epoch 74 cost:  0.029 train error: 62.91% test error: 59.26%
Epoch 75 cost:  0.029 train error: 61.97% test error: 51.85%
Epoch 76 cost:  0.029 train error: 69.01% test error: 55.56%
Epoch 77 cost:  0.030 train error: 66.20% test error: 55.56%
Epoch 78 cost:  0.029 train error: 60.56% test error: 44.44%
Epoch 79 cost:  0.030 train error: 68.08% test error: 50.00%
Epoch 80 cost:  0.028 train error: 62.44% test error: 55.56%
Epoch 81 cost:  0.028 train error: 64.32% test error: 53.70%
Epoch 82 cost:  0.028 train error: 65.26% test error: 61.11%
Epoch 83 cost:  0.028 train error: 62.91% test error: 59.26%
Epoch 84 cost:  0.036 train error: 69.48% test error: 77.78%
Epoch 85 cost:  0.028 train error: 66.67% test error: 50.00%
Epoch 86 cost:  0.032 train error: 70.42% test error: 79.63%
Epoch 87 cost:  0.028 train error: 65.26% test error: 72.22%
Epoch 88 cost:  0.026 train error: 67.14% test error: 50.00%
Epoch 89 cost:  0.034 train error: 68.08% test error: 79.63%
Epoch 90 cost:  0.027 train error: 62.91% test error: 48.15%
Epoch 91 cost:  0.038 train error: 69.95% test error: 85.19%
Epoch 92 cost:  0.029 train error: 69.95% test error: 59.26%
Epoch 93 cost:  0.026 train error: 61.50% test error: 48.15%
Epoch 94 cost:  0.026 train error: 66.67% test error: 50.00%
Epoch 95 cost:  0.028 train error: 65.73% test error: 57.41%
Epoch 96 cost:  0.029 train error: 62.91% test error: 59.26%
Epoch 97 cost:  0.027 train error: 66.67% test error: 51.85%
Epoch 98 cost:  0.038 train error: 70.89% test error: 88.89%
Epoch 99 cost:  0.026 train error: 65.26% test error: 57.41%
Epoch 100 cost:  0.026 train error: 64.79% test error: 46.30%
Epoch 101 cost:  0.026 train error: 63.38% test error: 42.59%
Epoch 102 cost:  0.026 train error: 63.38% test error: 51.85%
Epoch 103 cost:  0.026 train error: 63.38% test error: 50.00%
Epoch 104 cost:  0.033 train error: 72.30% test error: 83.33%
Epoch 105 cost:  0.026 train error: 66.20% test error: 51.85%
Epoch 106 cost:  0.026 train error: 65.26% test error: 50.00%
Epoch 107 cost:  0.027 train error: 61.50% test error: 55.56%
Epoch 108 cost:  0.032 train error: 67.61% test error: 83.33%
Epoch 109 cost:  0.026 train error: 63.85% test error: 53.70%
Epoch 110 cost:  0.027 train error: 63.38% test error: 55.56%
Epoch 111 cost:  0.027 train error: 64.32% test error: 50.00%
Epoch 112 cost:  0.025 train error: 67.14% test error: 53.70%
Epoch 113 cost:  0.029 train error: 68.08% test error: 68.52%
Epoch 114 cost:  0.027 train error: 65.73% test error: 66.67%
Epoch 115 cost:  0.025 train error: 64.79% test error: 48.15%
Epoch 116 cost:  0.026 train error: 66.20% test error: 48.15%
Epoch 117 cost:  0.026 train error: 61.97% test error: 46.30%
Epoch 118 cost:  0.025 train error: 66.67% test error: 55.56%
Epoch 119 cost:  0.025 train error: 65.73% test error: 51.85%
Epoch 120 cost:  0.026 train error: 65.26% test error: 53.70%
Epoch 121 cost:  0.026 train error: 66.20% test error: 53.70%
Epoch 122 cost:  0.025 train error: 65.73% test error: 50.00%
Epoch 123 cost:  0.026 train error: 68.08% test error: 55.56%
Epoch 124 cost:  0.025 train error: 65.26% test error: 50.00%
Epoch 125 cost:  0.028 train error: 65.26% test error: 62.96%
Epoch 126 cost:  0.025 train error: 66.20% test error: 51.85%
Epoch 127 cost:  0.026 train error: 64.32% test error: 53.70%
Epoch 128 cost:  0.026 train error: 65.73% test error: 50.00%
Epoch 129 cost:  0.025 train error: 65.26% test error: 44.44%
Epoch 130 cost:  0.025 train error: 66.20% test error: 50.00%
Epoch 131 cost:  0.026 train error: 65.26% test error: 51.85%
Epoch 132 cost:  0.025 train error: 65.26% test error: 50.00%
Epoch 133 cost:  0.030 train error: 73.24% test error: 75.93%
Epoch 134 cost:  0.025 train error: 64.79% test error: 50.00%
Epoch 135 cost:  0.024 train error: 66.20% test error: 50.00%
Epoch 136 cost:  0.025 train error: 65.73% test error: 50.00%
Epoch 137 cost:  0.026 train error: 64.32% test error: 51.85%
Epoch 138 cost:  0.025 train error: 65.73% test error: 50.00%
Epoch 139 cost:  0.028 train error: 69.48% test error: 74.07%
Epoch 140 cost:  0.025 train error: 66.20% test error: 50.00%
Epoch 141 cost:  0.024 train error: 66.20% test error: 50.00%
Epoch 142 cost:  0.025 train error: 66.20% test error: 50.00%
Epoch 143 cost:  0.025 train error: 64.79% test error: 51.85%
Epoch 144 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 145 cost:  0.027 train error: 68.08% test error: 55.56%
Epoch 146 cost:  0.024 train error: 67.14% test error: 51.85%
Epoch 147 cost:  0.027 train error: 69.01% test error: 62.96%
Epoch 148 cost:  0.025 train error: 66.67% test error: 53.70%
Epoch 149 cost:  0.025 train error: 65.73% test error: 51.85%
Epoch 150 cost:  0.025 train error: 65.73% test error: 50.00%
Epoch 151 cost:  0.028 train error: 65.26% test error: 57.41%
Epoch 152 cost:  0.024 train error: 66.20% test error: 50.00%
Epoch 153 cost:  0.025 train error: 66.20% test error: 51.85%
Epoch 154 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 155 cost:  0.025 train error: 67.14% test error: 48.15%
Epoch 156 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 157 cost:  0.024 train error: 65.73% test error: 53.70%
Epoch 158 cost:  0.024 train error: 66.20% test error: 50.00%
Epoch 159 cost:  0.025 train error: 64.32% test error: 51.85%
Epoch 160 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 161 cost:  0.025 train error: 66.20% test error: 51.85%
Epoch 162 cost:  0.025 train error: 65.73% test error: 50.00%
Epoch 163 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 164 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 165 cost:  0.025 train error: 65.73% test error: 48.15%
Epoch 166 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 167 cost:  0.025 train error: 65.73% test error: 50.00%
Epoch 168 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 169 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 170 cost:  0.024 train error: 66.20% test error: 50.00%
Epoch 171 cost:  0.025 train error: 64.32% test error: 50.00%
Epoch 172 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 173 cost:  0.024 train error: 62.44% test error: 48.15%
Epoch 174 cost:  0.025 train error: 67.14% test error: 50.00%
Epoch 175 cost:  0.025 train error: 65.73% test error: 51.85%
Epoch 176 cost:  0.025 train error: 66.20% test error: 53.70%
Epoch 177 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 178 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 179 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 180 cost:  0.025 train error: 66.67% test error: 51.85%
Epoch 181 cost:  0.025 train error: 67.14% test error: 50.00%
Epoch 182 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 183 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 184 cost:  0.025 train error: 65.73% test error: 48.15%
Epoch 185 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 186 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 187 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 188 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 189 cost:  0.023 train error: 65.73% test error: 50.00%
Epoch 190 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 191 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 192 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 193 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 194 cost:  0.025 train error: 65.73% test error: 50.00%
Epoch 195 cost:  0.023 train error: 65.73% test error: 50.00%
Epoch 196 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 197 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 198 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 199 cost:  0.024 train error: 65.73% test error: 50.00%
Epoch 200 cost:  0.025 train error: 65.73% test error: 50.00%
[(-0.15096438582986593, 2.68888336424278), (-0.2282613655552268, -0.03636127524187494), (-0.19242854323238134, 0.10002987905479344), (-0.18915690016001463, 1.517303264130159), (-0.0668008578941226, 0.06264130819889213), (-0.1477942569181323, -0.5097599036329276), (-0.20135000813752413, 0.5033827910594519), (-0.22701777052134275, -0.1967670336730903), (-0.15658221673220396, -0.09857748482930682), (-0.20122460555285215, -0.8434037115621471), (-0.163328112103045, -0.9319057958170887), (-0.12970042880624533, 0.3744983315768511), (-0.12752523180097342, -0.7189088627054887), (-0.11175747495144606, 0.7699327875045279), (-0.09430467616766691, 0.9822043319061996), (-0.19857531879097223, 0.9817479782001197), (-0.25689087342470884, 1.6321988230551623), (-0.17600941937416792, -0.5704262931513064), (-0.09893791284412146, 1.668147964049053), (-0.2456808229908347, 0.0), (-0.07889841217547655, 0.5469257899202619), (-0.13484291266649961, 0.129491117525967), (-0.3085983218625188, 0.5777336337395744), (-0.17330863047391176, 0.2657336540564141), (-0.07436468731611967, 0.09404268386304092), (-0.05399796646088362, -0.6577674429955217), (-0.1726630376651883, 0.1978384287329926), (-0.11116189416497946, 0.6350726835563982), (-0.11591811198741198, -0.4264234634703598), (-0.18985264468938112, -0.025689734417074964), (-0.15601448249071836, -0.7795429198728877), (-0.05859762895852327, 0.2848804585571224), (-0.127537758089602, -0.11190683448593444), (-0.1991405850276351, 0.5085417961910798), (-0.2358273370191455, 1.1148285673289329), (-0.26194637175649405, 0.9158967135012738), (-0.2680472796782851, 0.1009189021875595), (-0.20239257719367743, 0.5373203364569159), (-0.07557214703410864, -0.4175566334081075), (-0.14617859851568937, -0.17615876362043456), (-0.24563369806855917, 0.8064979220465356), (-0.177652551792562, -0.008332036766386249), (-0.1140720909461379, -0.17498735210466132), (-0.2669150708243251,0.18364143243725156), (-0.16661935951560736, 0.06665629413110206), (-0.2693957416340709, -0.09159135302859948), (-0.19568062853068113, 1.592072040813379), (-0.2762844553217292, 0.04922108470547297), (-0.2458180533722043, 0.00819947824544425), (-0.21355568896979094, -0.2624454528418042), (-0.1488602953031659, -0.2301706399901355), (-0.14216171111911535, 6.098039792671178), (-0.17142549622803926, 1.196168457287398), (-0.19961686339229345, 0.9517313852883365)]
[('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'DOWN'), ('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'DOWN'), ('STAY', 'DOWN'), ('STAY', 'STAY'), ('STAY', 'DOWN'), ('STAY', 'UP'), ('STAY', 'UP'), ('STAY', 'UP'), ('STAY', 'UP'), ('STAY', 'DOWN'), ('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'DOWN'), ('STAY', 'STAY'), ('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'DOWN'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'UP'), ('STAY', 'UP'), ('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'UP'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'STAY'), ('STAY', 'UP'), ('STAY', 'UP'), ('STAY', 'UP')]
50.0